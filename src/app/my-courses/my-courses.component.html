<!-- ----------- Top Announcements & Live/Quiz ------------- -->
<div class="max-w-6xl mx-auto px-2 py-6">
  <!-- Announcements and live session -->
  <ng-container *ngIf="view === 'dashboard'">
    <div *ngFor="let ann of announcements" class="mb-2 flex items-center rounded-lg bg-indigo-50 border border-indigo-100 px-4 py-2 shadow-sm text-indigo-900">
      <span class="text-xl mr-3">{{ann.icon}}</span>
      <span class="flex-1">{{ann.message}}</span>
      <a *ngIf="ann.link" [href]="ann.link" class="ml-4 text-sm font-semibold text-green-700 bg-green-100 rounded px-3 py-1 border" target="_blank">
        {{ann.cta}}
      </a>
    </div>

    <!-- Enrolled Courses Grid -->
    <h2 class="mt-8 mb-4 text-xl font-bold text-indigo-900">Enrolled Courses</h2>
    <div class="grid gap-5 grid-cols-1 md:grid-cols-2 xl:grid-cols-3">
      <div *ngFor="let course of enrolledCourses" class="bg-white rounded-2xl shadow overflow-hidden flex flex-col">
        <div class="h-32 w-full relative">
          <img [src]="course.image" class="rounded-t-2xl object-cover h-full w-full" />
          <span *ngIf="course.live.isLive"
                class="absolute top-2 left-2 bg-red-600 text-white py-1 px-3 text-xs rounded shadow">LIVE</span>
          <span *ngIf="course.quizzing.isQuizLive"
                class="absolute top-2 right-2 bg-yellow-500 text-white py-1 px-3 text-xs rounded shadow">Quiz Live</span>
        </div>
        <div class="p-5 flex-1 flex flex-col">
          <div class="flex items-center justify-between text-sm text-gray-500 mb-1">
            <span class="font-semibold">{{course.batch}}</span>
            <span>{{course.status}}</span>
          </div>
          <h3 class="font-bold text-lg text-indigo-900 mb-1">{{course.title}}</h3>
          <div class="text-sm text-gray-700 mb-2">Current Topic: <span class="font-semibold">{{course.currentTopic}}</span></div>
          <div class="h-2 w-full bg-indigo-100 rounded-full overflow-hidden mb-4 relative">
            <div class="h-2 bg-indigo-600 rounded-full" [style.width.%]="course.percent"></div>
            <span class="absolute right-2 top-[-18px] text-gray-500 text-xs">{{course.percent}}%</span>
          </div>
          <button (click)="continueLearning(course)"
                  class="w-full mt-auto h-10 rounded-lg bg-indigo-600 text-white font-bold hover:bg-indigo-700 transition">
            Continue Learning
          </button>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- -------- Course View: After Card Click -------- -->
  <ng-container *ngIf="view === 'course' && selectedCourse">
    <div class="flex items-center mb-4">
      <button (click)="goBack()" class="px-3 py-2 rounded hover:bg-indigo-50 mr-2 font-bold text-indigo-600">&larr; Back</button>
      <h2 class="text-2xl font-bold text-indigo-900 flex-1">{{selectedCourse.title}}</h2>
      <!-- Show "Join Live" if live class open -->
      <a *ngIf="selectedCourse.live.isLive"
         [href]="selectedCourse.live.joinUrl"
         target="_blank"
         class="bg-red-600 text-white font-semibold px-4 py-2 rounded-lg shadow ml-3 hover:bg-red-700 transition">
        Join Live Class
      </a>
    </div>
    <div class="flex gap-3 items-center mb-4">
      <span class="font-semibold text-indigo-800">Progress:</span>
      <div class="relative w-72 h-3 bg-indigo-200 rounded-full">
        <div class="absolute h-3 bg-green-500 rounded-full" [style.width.%]="selectedCourse.percent"></div>
      </div>
      <span class="ml-2 text-sm text-indigo-600 font-semibold">{{selectedCourse.percent}}%</span>
    </div>

    <!-- Tabs -->
    <div class="flex border-b border-indigo-100 mb-6 space-x-6">
      <button *ngFor="let tab of ['chapters','live','quiz','notes','progress']"
              (click)="activeTab = tab"
              class="pb-2 px-2 text-lg font-semibold"
              [ngClass]="{'text-indigo-800 border-b-2 border-indigo-600': activeTab === tab, 'text-gray-500': activeTab !== tab}">
        {{tab | titlecase}}
      </button>
    </div>

    <div class="bg-white rounded-xl shadow p-6 min-h-[200px]">
      <!-- Chapters (show only if tab active) -->
      <ng-container *ngIf="activeTab === 'chapters'">
        <!-- <h3 class="font-semibold text-indigo-700 mb-2">Continue Where You Left</h3>
        <div class="flex items-center bg-indigo-50 p-4 rounded-lg mb-6">
          <span class="font-bold text-base text-green-700 mr-4">Java Basics</span>
          <span class="text-gray-600 text-sm">Background Part 1 (IO Devices, CPU and Memory)</span>
          <button class="ml-auto bg-green-600 text-white rounded px-4 py-1 font-semibold hover:bg-green-700 transition">Resume</button>
        </div> -->
        <div>
          <details class="mb-3">
            <summary class="cursor-pointer py-2 text-lg font-bold text-indigo-700 pl-1">Java Fundamentals</summary>
            <ul class="pl-6 mt-2 space-y-2">
              <li class="text-sm flex items-center"><span class="mr-3">•</span>Java Basics</li>
              <li class="text-sm flex items-center"><span class="mr-3">•</span>OOPs & Advanced</li>
            </ul>
          </details>
        </div>
      </ng-container>

      <!-- LIVE tab -->
      <ng-container *ngIf="activeTab === 'live'">
        <div class="mb-3">
          <span class="font-bold text-green-700">Live Classes Attendance:</span>
        </div>
        <table class="w-full mt-2 text-left border rounded shadow-sm">
          <thead>
            <tr class="bg-indigo-50">
              <th class="py-1 px-2 font-medium">Date</th>
              <th class="py-1 px-2 font-medium">Topic</th>
              <th class="py-1 px-2 font-medium">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="py-1 px-2">21 Oct 2025, 7:30 PM</td>
              <td class="py-1 px-2">Polymorphism Deep Dive</td>
              <td class="py-1 px-2 text-green-800 font-bold">Attended</td>
            </tr>
            <tr>
              <td class="py-1 px-2">20 Oct 2025, 7:30 PM</td>
              <td class="py-1 px-2">Inheritance Basics</td>
              <td class="py-1 px-2 text-red-800 font-bold">Missed</td>
            </tr>
          </tbody>
        </table>
      </ng-container>

      <!-- Quiz tab -->
      <ng-container *ngIf="activeTab === 'quiz'">
        <div class="mb-3">
          <span class="font-bold text-indigo-800">Quiz/Test Schedule:</span>
        </div>
        <ul class="divide-y">
          <li class="py-3 flex items-center">
            <span class="flex-1">Mock Test #2 &mdash; 21 Oct 2025, 8:00 PM</span>
            <span class="rounded px-3 py-1 bg-green-100 text-green-800 font-medium">Attended</span>
            <a class="ml-4 text-blue-700 font-bold hover:underline" href="/quiz/857" target="_blank">View</a>
          </li>
          <li class="py-3 flex items-center">
            <span class="flex-1">Quiz on Arrays &mdash; 19 Oct 2025, 7:30 PM</span>
            <span class="rounded px-3 py-1 bg-red-100 text-red-800 font-medium">Missed</span>
          </li>
        </ul>
      </ng-container>

      <!-- Notes tab -->
      <ng-container *ngIf="activeTab === 'notes'">
        <ul class="divide-y">
          <li class="py-3 flex items-center">
            <span class="flex-1">Lecture Notes - OOPS</span>
            <a class="ml-5 text-blue-600 underline" href="/notes/123" target="_blank">View</a>
            <a class="ml-3 text-gray-700 underline" href="/notes/123.pdf" download>Download</a>
          </li>
          <li class="py-3 flex items-center">
            <span class="flex-1">Sample Problem Set</span>
            <a class="ml-5 text-blue-600 underline" href="/notes/124" target="_blank">View</a>
            <a class="ml-3 text-gray-700 underline" href="/notes/124.pdf" download>Download</a>
          </li>
        </ul>
      </ng-container>

      <!-- Progress tab -->
      <ng-container *ngIf="activeTab === 'progress'">
        <div class="font-bold text-green-800 mb-2">Course Progress</div>
        <ul class="text-sm space-y-2">
          <li>Chapters Completed: <span class="font-semibold text-indigo-800">3/12</span></li>
          <li>Live Classes Attended: <span class="font-semibold text-indigo-800">4/26</span></li>
          <li>Quiz/tests cleared: <span class="font-semibold text-indigo-800">2/7</span></li>
          <li>Certificate: <span class="text-gray-700">Available after 70%</span></li>
        </ul>
      </ng-container>
    </div>
  </ng-container>
</div>
