<!-- course-details.component.html -->
<div class="space-y-6">
  <!-- Header / Hero -->
  <div class="grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6">
    <!-- Left: cover + meta -->
 
    <section class="bg-white rounded-xl shadow p-4 sm:p-6">
      <div class="aspect-[16/9] w-full rounded-lg overflow-hidden bg-[#EBF2FF]">
        <img [src]="Course?.CourseImage" alt="" class="w-full h-full object-cover" />
      </div>

      <h1 class="mt-4 text-2xl font-bold text-[#303F9F]">
        {{ Course?.CourseName }}
      </h1>

      <div class="mt-2 text-sm text-gray-700">
        <span class="font-medium"> Dr.Bagchi</span>
        <span class="mx-2">•</span>
        <span>{{ Course?.CourseLevel }}</span>
        <!-- <span class="mx-2">•</span>
        <span>{{ course?.duration }}</span> -->
      </div>

      <div class="mt-2 flex items-center gap-2 text-sm">
        <div class="flex items-center gap-1 text-amber-500">
          <svg class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.463c.969 0 1.371 1.24.588 1.81l-2.802 2.035a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.538 1.118l-2.802-2.035a1 1 0 00-1.176 0L7.614 16.28c-.783.57-1.838-.197-1.538-1.118l1.07-3.292a1 1 0 00-.364-1.118L3.98 8.72c-.783-.57-.38-1.81.588-1.81h3.463a1 1 0 00.95-.69l1.07-3.292z"/>
          </svg>
         </div>
       </div>

      <!-- Course Description Section -->
<div class="mt-6 bg-gray-50 rounded-xl p-4 sm:p-6 shadow-inner">
  <h2 class="text-xl font-semibold text-[#303F9F] mb-3">Course Description</h2>

  <!-- Overview -->
  <p class="text-gray-700 mb-4">
    {{ parsedDescription?.overview }}
  </p>
  <p class="text-gray-600 italic mb-4 line-clamp-4">
    {{ parsedDescription?.shortDescription }}
  </p>

  <!-- Duration & Level -->
  <div class="flex flex-col sm:flex-row gap-2 sm:gap-6 text-sm text-gray-600 mb-4">
    <div>
      <span class="font-medium text-gray-800">Duration:</span>
      {{ parsedDescription?.duration }}
    </div>
    <div>
      <span class="font-medium text-gray-800">Level:</span>
      {{ parsedDescription?.level }}
    </div>
  </div>

  <!-- Highlights -->
  <div>
    <h3 class="text-lg font-medium text-gray-800 mb-2">Highlights</h3>
    <ul class="grid grid-cols-1 sm:grid-cols-2 gap-2">
      <li *ngFor="let item of parsedDescription?.highlights"
          class="flex items-start gap-2 text-gray-700 bg-white p-2 rounded-lg shadow-sm">
        <span class="text-[#3F51B5] mt-1">✔</span>
        <span>{{ item }}</span>
      </li>
    </ul>
  </div>
</div>

    </section>

    <!-- Right: price + coupon + pay -->
    <aside class="bg-white rounded-xl shadow p-4 sm:p-6 h-max">
      <div class="flex items-baseline gap-3">
        <div class="text-2xl font-bold text-[#3F51B5]">₹{{ totals?.finalPrice }}</div>
        <div *ngIf="totals?.discount > 0" class="text-sm text-gray-500 line-through">₹{{ totals?.basePrice }}</div>
      </div>

      <div class="mt-1 text-xs text-gray-600">
        Tax inclusive where applicable.
      </div>

      <!-- Coupon -->
      <div class="mt-4">
        <label class="block text-sm font-medium text-gray-800 mb-1">Coupon code</label>
        <div class="flex items-center gap-2">
          <input
            type="text"
            [(ngModel)]="couponCode"
            placeholder="Enter coupon (e.g., FLAT100)"
            class="flex-1 h-10 rounded-lg border border-[#C5CAE9] bg-white px-3 text-sm focus:outline-none focus:ring-2 focus:ring-[#3F51B5]"
          />
          <button
            (click)="applyCoupon()"
            class="h-10 rounded-lg bg-[#3F51B5] text-white text-sm font-medium px-4 hover:bg-[#303F9F] transition"
          >
            Apply
          </button>
        </div>

        <!-- Coupon feedback -->
        <div *ngIf="couponMessage"
             class="mt-2 text-sm"
             [ngClass]="{ 'text-green-700': couponValid, 'text-red-700': !couponValid }">
          {{ couponMessage }}
        </div>

        <!-- Price breakdown -->
        <div class="mt-4 rounded-lg bg-[#EBF2FF] p-3 text-sm">
          <div class="flex justify-between">
            <span>Base price</span>
            <span>₹{{ totals?.basePrice }}</span>
          </div>
          <div class="flex justify-between" *ngIf="totals?.discount > 0">
            <span>Discount</span>
            <span class="text-green-700">- ₹{{ totals?.discount }}</span>
          </div>
          <div class="mt-2 pt-2 border-t border-[#C5CAE9] flex justify-between font-semibold">
            <span>Total</span>
            <span>₹{{ totals?.finalPrice }}</span>
          </div>
        </div>
      </div>

      <button
        class="mt-4 w-full h-11 rounded-lg bg-green-600 text-white font-semibold hover:bg-green-700 transition"
        (click)="payNow()"
      >
        Pay Now
      </button>

      <div *ngIf="paymentMessage" class="mt-3 text-sm text-gray-700">
        {{ paymentMessage }}
      </div>
    </aside>
  </div>

  <!-- Curriculum -->
  <section class="bg-white rounded-xl shadow p-4 sm:p-6">
    <h2 class="text-lg font-semibold text-[#3F51B5]">Course Content</h2>
    <p class="text-sm text-gray-600">Chapters, lessons, and topics. Click a lesson to expand topics.</p>

    <div class="mt-4 divide-y divide-[#EBF2FF]">
      <!-- Chapter -->
      <div *ngFor="let ch of Course?.chapters; let ci = index" class="py-3">
        <div class="flex items-center justify-between">
          <div class="font-semibold text-gray-900">
            {{ ch.title }} <span class="text-sm text-gray-500">({{ ch.lessons?.length }} lessons)</span>
          </div>
          <div class="text-xs text-gray-600">{{ ch.estimated }}</div>
        </div>

        <!-- Lessons -->
        <div class="mt-2 rounded-lg border border-[#EBF2FF] divide-y">
          <div *ngFor="let ls of ch.lessons; let li = index" class="bg-white">
            <button
              class="w-full flex items-center justify-between px-3 py-2 text-left hover:bg-indigo-50 transition"
              (click)="toggleLesson(ci, li)"
            >
              <div class="flex items-center gap-2">
                <svg class="w-4 h-4 text-[#3F51B5]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 20l9-5-9-5-9 5 9 5z"/>
                </svg>
                <span class="font-medium text-gray-900">{{ ls.title }}</span>
              </div>
              <svg
                class="w-4 h-4 text-gray-600 transition-transform"
                [ngClass]="{ 'rotate-180': isLessonOpen(ci, li) }"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"/>
              </svg>
            </button>

            <!-- Topics -->
            <div
              class="px-4 pb-3 pt-1 text-sm text-gray-700"
              *ngIf="isLessonOpen(ci, li)"
            >
              <ul class="list-disc pl-5 space-y-1">
                <li *ngFor="let t of ls.topics">{{ t }}</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
